<div {% if is_oob %}hx-swap-oob="true"{% endif %} id="entries_table">

  {% include "entries/components/entry_filter.html" with filter_url=filter_url filter_target="#content-container" status_options=status_options type_options=type_options team_options=team_options workspace_options=workspace_options %}

  <div id="table" class="mt-4 overflow-x-auto w-full">
  
    <table class="table w-full">
      <thead>
        <tr>
          <th>
            <label>
              <input
                type="checkbox"
                id="select-all"
                class="checkbox checkbox-xs md:checkbox-sm checkbox-secondary/25"
                onclick="toggleSelectAll(this)"
              />
            </label>
          </th>
          <th>Submitted By</th>
          <th>Description</th>
          <th class="text-center">Status</th>
          <th class="text-center">Type</th>
          <th>Amount</th>
          <th>Currency</th>
          <th>Exchange Rate</th>
          <th>Converted Amount</th>
          <th>Occurred On</th>
          <th>Last Reviewed By</th>
          <th class="text-center">Created At</th>
          <th class="text-center">Actions</th>
        </tr>
      </thead>
  
  
      <tbody>
        {% for entry in entries %}
          {% include "entries/partials/row.html" with entry=entry %}
        {% empty %}
          <tr>
            <td colspan="8" class="text-center p-4 text-sm text-neutral">
              No Expense Entries found
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  
    {% if is_paginated %}
      {% include "components/pagination.html" with request=request %}
    {% endif %}
  </div>

</div>


<script>
  function updateBulkActions() {
    const checkboxes = document.querySelectorAll('.bulk-checkbox');
    const checked = document.querySelectorAll('.bulk-checkbox:checked');
    const button = document.getElementById('bulk-select-button');
    const countSpan = document.getElementById('selected-count');
    const selectAll = document.getElementById('select-all');

    const count = checked.length;

    // Update button visibility and text
    if (count > 0) {
      button.classList.remove('hidden');
      document.getElementById('selected-count').textContent = count;
    } else {
      button.classList.add('hidden');
    }

    // Update "Select All" checkbox
    if (count === 0) {
      selectAll.checked = false;
      selectAll.indeterminate = false;
    } else if (count === checkboxes.length) {
      selectAll.checked = true;
      selectAll.indeterminate = false;
    } else {
      selectAll.checked = false;
      selectAll.indeterminate = true;
    }
  }

  function toggleSelectAll(source) {
    const checkboxes = document.querySelectorAll('.bulk-checkbox');
    const isChecked = source.checked;
    checkboxes.forEach(cb => {
      cb.checked = isChecked;
    });
    updateBulkActions();
  }

  function clearSelection() {
    document.querySelectorAll('.bulk-checkbox:checked').forEach(cb => {
      cb.checked = false;
    });
    updateBulkActions();
  }

  // Init
  document.addEventListener('DOMContentLoaded', () => {
    const checkboxes = document.querySelectorAll('.bulk-checkbox');
    checkboxes.forEach(cb => cb.addEventListener('change', updateBulkActions));
    updateBulkActions();
  });

</script>