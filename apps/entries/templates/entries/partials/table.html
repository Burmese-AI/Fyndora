<div {% if is_oob %}hx-swap-oob="true"{% endif %} id="table" class="overflow-x-auto w-full">

  <table class="table w-full">
    <thead>
      <tr>
        <th>
          <label>
            <input
              type="checkbox"
              id="select-all"
              class="checkbox checkbox-xs md:checkbox-sm checkbox-secondary/25"
              onclick="toggleSelectAll(this)"
            />
          </label>
        </th>
        <th>Submitted By</th>
        <th>Description</th>
        <th class="text-center">Type</th>
        <th>Amount</th>
        <th>Currency</th>
        <th>Exchange Rate</th>
        <th>Converted Amount</th>
        <th>Occurred On</th>
        <th class="text-center">Status</th>
        <th>Last Reviewed By</th>
        <th class="text-center">Created At</th>
        <th class="text-center">Actions</th>
      </tr>
    </thead>


    <tbody>
      {% for entry in entries %}
        {% include "entries/partials/row.html" with entry=entry %}
      {% empty %}
        <tr>
          <td colspan="8" class="text-center p-4 text-sm text-neutral">
            No Expense Entries found
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  {% if is_paginated %}
    {% include "components/pagination.html" %}
  {% endif %}
</div>

<script>
  function updateBulkActions() {
    const checkboxes = document.querySelectorAll('.bulk-checkbox');
    const checked = document.querySelectorAll('.bulk-checkbox:checked');
    const button = document.getElementById('bulk-select-button');
    const countSpan = document.getElementById('selected-count');
    const selectAll = document.getElementById('select-all');

    const count = checked.length;

    // Update button visibility and text
    if (count > 0) {
      button.classList.remove('hidden');
      document.getElementById('selected-count').textContent = count;
    } else {
      button.classList.add('hidden');
    }

    // Update "Select All" checkbox
    if (count === 0) {
      selectAll.checked = false;
      selectAll.indeterminate = false;
    } else if (count === checkboxes.length) {
      selectAll.checked = true;
      selectAll.indeterminate = false;
    } else {
      selectAll.checked = false;
      selectAll.indeterminate = true;
    }
  }

  function toggleSelectAll(source) {
    const checkboxes = document.querySelectorAll('.bulk-checkbox');
    const isChecked = source.checked;
    checkboxes.forEach(cb => {
      cb.checked = isChecked;
    });
    updateBulkActions();
  }

  function clearSelection() {
    document.querySelectorAll('.bulk-checkbox:checked').forEach(cb => {
      cb.checked = false;
    });
    updateBulkActions();
  }

  // Init
  document.addEventListener('DOMContentLoaded', () => {
    const checkboxes = document.querySelectorAll('.bulk-checkbox');
    checkboxes.forEach(cb => cb.addEventListener('change', updateBulkActions));
    updateBulkActions();
  });

</script>